<div id="cont" style="width:200%;position:absolute;left:0px;top:0px;height:100%;z-index:2;">
	<div id="ground" style="width:100%;height:70%;position:absolute;left:0px;bottom:0px;background-color:#013220;"></div>
	<div id="sky" style="width:100%;height:30%;position:absolute;left:0px;top:0px;background-color:#87ceeb;"></div>
</div>
<div id="writing" style="width:100%;height:100%;position:absolute;left:0px;top:0px;background-color:#696969;">
		<img src="writing.png" style="width:30%;position:absolute;top:20%;left:35%;">
	</div>
<div id="resume" style="width:15%; position:absolute;text-align:center;display:none;left:50%;top:50%;translate: -50% -50%;background-color:#696969;z-index:3;cursor:pointer;" onclick="lock();"><h2>Resume</h2></div>
<div id="start" style="width:15%; position:absolute;text-align:center;left:50%;top:50%;translate: -50% -50%;background-color:#696969;z-index:3;cursor:pointer;" onclick="run();lock();"><h2>Start</h2></div>

<img src="/img/gun.png" id="gun" style="width:35%;position:absolute;right:0px;bottom:0px; z-index:100;">
<img src="/img/gunshot.png" id="gunshot" style="width:35%;position:absolute;transform:rotate(5deg);display:none;right:0px;bottom:0px; z-index:9999999999999;">

<img src="/img/target.png" id="target" style="display:none;width:7%;position:absolute;left:50%;top:50%;translate: -50% -50%;z-index:9999999999999;">
<script>
	var paused=false;
	
	function lock(){
			cont.requestPointerLock = cont.requestPointerLock ||
		                 cont.mozRequestPointerLock ||
		                 cont.webkitRequestPointerLock;
			cont.requestPointerLock();
		document.getElementById("resume").style.display="none";
		paused=false;
		}
	
	
	window.onerror = function(msg, url, linenumber) {
		alert('Error message: ' + msg + '\nURL: ' + url + '\nLine Number: ' + linenumber);
		return true;
	};

	function run(){		
		document.addEventListener("pointerlockchange", lockChangeAlert, false);

		function lockChangeAlert() {
		  if (document.pointerLockElement === cont) {
			  		pause=false;
		  } else {
		    paused=true;
		    document.getElementById("resume").style.display="block";
		  }
		}

		
		document.getElementById("start").style.display="none";
		
		var cont=document.getElementById("cont");
		var target=document.getElementById("target");
		var gunshot=document.getElementById("gunshot");
		var gun=document.getElementById("gun");
		var contleft=0;
		var conttop=0;
		
		setInterval(() => {
			if (!paused){
				var enemyx = Math.floor(Math.random() * window.innerWidth * 2);
				var enemyy = (window.innerHeight/100)*30;
				var enemywidth = 0;
				var enemyheight = 0;
				var enemy = document.createElement("img");
				enemy.src="/img/zombie.png";
				enemy.style = "width:" + enemywidth + "px;height:" + enemyheight + "px;background:transparent;position:absolute;top:" + enemyy + "px;left:" + enemyx + "px;";
				cont.appendChild(enemy);
				setInterval(() => {
					if (!paused){
						enemyy = enemyy + window.innerWidth / 500;
						enemywidth = enemywidth + 12;
						enemyheight = enemyheight + 18;
						enemy.style.width = enemywidth + "px";
						enemy.style.height = enemyheight + "px";
						enemy.style.top = enemyy + "px";
						enemy.style.left = enemyx + "px";
						if (enemyheight > window.innerHeight) {
							enemy.remove();
						}
					}
				}, 50);
			}
		}, 100);

		setInterval(() => {
			if (!paused){
				if (document.pointerLockElement === cont) {
				  } else {
				    lock();
				  }
				target.style.display="block";
			}
			else{
				target.style.display="none";
			}
		},0);
		
		document.onmousemove = detectangle;
		document.onclick = shot;

		function shot(){
			if (!paused){
				gunshot.style.display="block";
				gun.style.display="none";
				setTimeout(() => {
					gun.style.display="block";
					gunshot.style.display="none";
				},100);
			}
		}
		
		function detectangle(event) {
		  if (!paused){
			  var x = event.movementX;
			  var y = event.movementY;
			  var writing=document.getElementById("writing");
			  contleft=contleft+x;
			  conttop=conttop+y;
		
			  if (conttop<0){
			  	document.body.style.backgroundColor="#013220";
			  }
			  else if (conttop>0){
			  	document.body.style.backgroundColor="#87ceeb";
			  }
			  if (contleft<=window.innerWidth*-2){
			    contleft=window.innerWidth;
			  }
			  else if (contleft>=window.innerWidth){
			    contleft=window.innerWidth*-2;
			  }
		
			  if (contleft<=window.innerWidth*-1){
			    writing.style.left=contleft+window.innerWidth*2;
			  }
			  if (contleft>=0){
			    writing.style.left=contleft-window.innerWidth;
			  }
				
			  cont.style.left=contleft+"px";
			  cont.style.top=conttop+"px";
		
			  writing.style.top=conttop+"px";
		  }
		}
	}
</script>
<style>
	body{
		overflow:hidden;
	}
</style>
